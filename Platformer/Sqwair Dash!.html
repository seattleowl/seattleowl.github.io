<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
	<canvas id="canvas"></canvas>
</body>
<script>
	var canvas = document.getElementById('canvas'),
		ctx = canvas.getContext("2d"),
		gravity = 0.3
		width = 500,
		height = 200,
		player = {
			x: width / 4,
			y: height - 30,
			width: 30,
			height: 30,
			velY: 0,
			jumping: false,
			grounded: false,
		},
		scroll = 0,
		boxes = [],
		killed = false;

	boxes.push({
		x: 0,
		y: height - 40,
		width: 1000,
		height: 40
	})

	canvas.width = width;
	canvas.height = height;

	function colCheck(shapeA, shapeB) {
	    // get the vectors to check against
	    var vX = (shapeA.x + (shapeA.width / 2)) - (shapeB.x + (shapeB.width / 2)),
	        vY = (shapeA.y + (shapeA.height / 2)) - (shapeB.y + (shapeB.height / 2)),
	        // add the half widths and half heights of the objects
	        hWidths = (shapeA.width / 2) + (shapeB.width / 2),
	        hHeights = (shapeA.height / 2) + (shapeB.height / 2),
	    	colDir = null;
	 
	    // if the x and y vector are less than the half width or half height, they we must be inside the object, causing a collision
	    if (Math.abs(vX) < hWidths && Math.abs(vY) < hHeights) { 
	    	// figures out on which side we are colliding (top, bottom, left, or right)         
	    	var oX = hWidths - Math.abs(vX),
	    		oY = hHeights - Math.abs(vY)
	    	if (oX >= oY) {
	            if (vY > 0) {
	                colDir = "t";
	                shapeA.y += oY;
	            } else {
	                colDir = "b";
	                shapeA.y -= oY;
	            }
	        } else {
	            if (vX > 0) {
	                colDir = "l";
	                shapeA.x += oX;
	            } else {
	                colDir = "r";
	                shapeA.x -= oX;
	            }
	        }
	    }
	    return colDir;
	}
	function update() {
		scroll += 1
		ctx.clearRect(0, 0, width, height);
		ctx.fillStyle = "black";
		ctx.beginPath();
		player.grounded = false

		if (player.grounded) {
			player.velY = 0
		}

		for (var i = 0; i < boxes.length; i++) {
			ctx.fillRect(boxes[i].x, boxes[i].y, boxes[i].width, boxes[i].height);
			var dir = colCheck(player, boxes[i]);
			if (dir === "l") {
     			killed == true
 			} else if (dir === "b") {
    			player.grounded = true;
    			player.jumping = false;
 			} else if (dir === "t") {
    			player.velY *= -1;
 			}
		}
		player.y += player.velY;
		ctx.fillStyle = "red";
		ctx.fillRect(player.x, player.y, player.width, player.height);
		console.log('running')
		if (! killed) {
			requestAnimationFrame(update);
		} else {
			player = {
				x: width / 4,
				y: height - 30,
				width: 30,
				height: 30,
				velY: 0,
				jumping: false,
				grounded: false,
			};
			scroll = 0;
			killed = false;

		}
	}
	window.addEventListener("load", function() {
		update();
	});
</script>
</html>